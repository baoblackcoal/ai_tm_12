
**核心设计原则 (贯穿所有阶段):**

*   **统一性 (Unity):** 跨平台（示波器嵌入式网页、PC Web、移动端/小程序、AR）提供一致的核心体验和视觉语言，但根据平台特性优化交互。
*   **情境感知 (Context-Aware):** AI 必须理解当前任务、示波器状态、历史交互，提供相关性强的辅助。
*   **用户控制与信任 (Control & Trust):** 特别是在控制示波器或硬件时，用户需要清晰了解 AI 的意图，有明确的确认/取消机制，并能随时接管。
*   **反馈清晰 (Clear Feedback):** AI 的状态、操作过程、结果都需要实时、明确地反馈给用户。
*   **效率优先 (Efficiency):** 简化操作流程，减少用户认知负荷，尤其是在专业测试场景下。
*   **高设计感 (Aesthetics):** 现代、简洁、专业、科技感。

---

## 阶段 2: 指令集 AI Agent 控制系统 (Control & Automation)

**完善需求:**

*   **核心功能:** 将用户的自然语言（文本/语音）指令转化为 SCPI (Standard Commands for Programmable Instruments) 或其他仪器控制命令，并执行。
*   **输入:** 文字、语音指令 (例如 "设置时基到 1 微秒", "帮我测一下通道 1 的峰峰值", "运行自动设置")。
*   **输出:**
    *   **确认信息:** 执行前显示将要发送的命令或操作计划，请求用户确认。
    *   **执行状态:** 显示命令发送、仪器响应、成功/失败状态。
    *   **结果反馈:** 获取并显示示波器返回的数据（测量值、状态参数）、截图。
    *   **文档生成:** 将当前示波器状态、设置、测量结果整理成结构化文本或报告格式。
*   **AI Agent 能力:**
    *   **意图理解:** 准确理解用户的测量意图，即使指令不完全精确。
    *   **多轮交互:** 支持连续指令，例如 "先设置通道 1 垂直灵敏度 1V，然后打开通道 2"。
    *   **状态查询与判断:** 能主动查询示波器当前状态（如触发状态、时基、测量项），判断任务是否完成或是否需要用户干预。
    *   **SCPI 知识:** 内建或可查询 SCPI 命令库，知道如何组合命令完成任务。
    *   **脚本生成:** 根据用户需求（如 "写个 Python 脚本，每秒读一次频率并记录"），自动生成基于 SCPI 的控制脚本 (如 Python with PyVISA)。
    *   **脚本调试:** 对生成的脚本进行基本语法检查，甚至尝试运行（在安全沙箱或经用户确认后）并根据错误信息进行修改。
*   **安全性:** 关键操作（如固件升级、恢复出厂设置）需要多重确认。避免发送可能导致仪器不稳定或损坏的命令序列。
*   **平台:** 主要在 **网页 (PC/Scope)** 上，因为通常连接和控制发生在这些环境。**移动端** 可作为远程监控和简单指令入口。

**UX 设计 (阶段 2):**

*   **核心用户流程:** 用户输入指令 -> AI 解析意图 -> **AI 提出操作计划/SCPI 命令预览** -> **用户审核并确认** -> AI 发送命令 -> AI 查询状态/结果 -> AI 反馈结果/状态 -> (循环或结束)。对于脚本生成：用户描述需求 -> AI 生成代码 -> **用户审查/编辑** -> AI (或用户) 运行/调试。
*   **UI 界面设计 (基于阶段 1):**
    *   **对话流集成:** 指令、确认请求、状态更新、结果反馈都在对话流中进行。
    *   **操作计划/命令预览:** 使用特殊卡片或格式化块清晰展示将要执行的操作或 SCPI 命令列表。必须包含醒目的 "确认执行" 和 "取消" 按钮。
    *   **状态指示器:** 在界面显著位置（如网页侧边栏或顶部状态栏）实时显示关键的示波器状态（连接状态、触发状态、运行/停止）。
    *   **结果展示:** 测量值以清晰格式显示。截图直接嵌入对话流。大量数据可提供下载或在表格中预览。
    *   **文档生成:** 提供 "生成报告" 或 "导出设置" 按钮，生成后可预览并下载（如 .txt, .csv, .md 格式）。
    *   **代码编辑器/查看器:**
        *   在对话流中嵌入代码块，带语法高亮、行号、复制按钮。
        *   提供简单的编辑功能（如果允许用户修改）。
        *   "运行" 按钮旁边可能需要有环境选择或安全提示。
        *   错误信息与代码行关联显示。
    *   **多轮交互视觉化:** 使用缩进、引用线或分组框将属于同一任务的多轮对话关联起来。
    *   **安全提示:** 对可能产生风险的操作（如修改配置、长时间运行脚本）进行明确警告。

*   **实例:**
    *   **场景:** 用户在 **PC 网页** 上，连接着示波器。
    *   **交互:** 用户输入语音 "帮我看看通道1方波的上升时间"。
    *   **AI 回答/交互:**
        1.  AI (文本气泡): "好的，我需要调整设置以准确测量上升时间。建议操作：1. 自动设置一次确保信号显示。2. 将时基调整到合适的范围。3. 打开上升时间测量项。 这是我计划发送的命令："
        2.  AI (命令预览卡片):
            ```scpi
            :AUTOSET EXECUTE  // 自动设置
            :MEASure:CLEar ALL // 清除旧测量
            :MEASure:RISetime CHANnel1 // 添加上升时间测量
            // 可能需要根据信号调整 :TIMebase:SCALe
            ```
            **[确认执行] [修改计划] [取消]**
        3.  用户点击 **[确认执行]**。
        4.  AI (状态气泡): "正在发送命令... 命令已发送... 正在获取测量结果..."
        5.  AI (结果气泡): "通道 1 的上升时间测量结果为： **10.2 ns** (数据来自 :MEASure:RESults?)" 并可能附带一张包含测量结果的屏幕截图。
        6.  AI (追问气泡): "测量完成。还需要其他帮助吗？"